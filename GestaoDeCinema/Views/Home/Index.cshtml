@model IEnumerable<GestaoDeCinema.Models.Filme>

@{
    Layout = null; // Definido como null para usar a estrutura HTML completa que enviaste
    ViewData["Title"] = "Filmes";
}

<!DOCTYPE html>
<html class="dark" lang="pt">
<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>@ViewData["Title"]</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;700;800&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet" />

    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#ec135b",
                        "background-light": "#f8f6f6",
                        "background-dark": "#181113",
                    },
                    fontFamily: {
                        display: ["Plus Jakarta Sans", "Noto Sans", "sans-serif"],
                    },
                },
            },
        };
    </script>
    <style>
        .material-symbols-outlined {
            font-variation-settings: "FILL" 0, "wght" 400, "GRAD" 0, "opsz" 24;
        }
    </style>
</head>
<body class="font-display">
    <div class="relative flex min-h-screen w-full flex-col bg-background-light dark:bg-background-dark group/design-root overflow-x-hidden">
        <div class="layout-container flex h-full grow flex-col">
            <div class="flex flex-1 justify-center py-5">
                <div class="layout-content-container flex w-full max-w-[960px] flex-1 flex-col">

                    <header class="flex items-center justify-between whitespace-nowrap border-b border-solid border-white/10 px-4 md:px-10 py-3">
                        <div class="flex items-center gap-8">
                            <div class="flex items-center gap-4 text-white">
                                <div class="size-6 text-primary">
                                    <svg fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M24 45.8096C19.6865 45.8096 15.4698 44.5305 11.8832 42.134C8.29667 39.7376 5.50128 36.3314 3.85056 32.3462C2.19985 28.361 1.76794 23.9758 2.60947 19.7452C3.451 15.5145 5.52816 11.6284 8.57829 8.5783C11.6284 5.52817 15.5145 3.45101 19.7452 2.60948C23.9758 1.76795 28.361 2.19986 32.3462 3.85057C36.3314 5.50129 39.7376 8.29668 42.134 11.8833C44.5305 15.4698 45.8096 19.6865 45.8096 24L24 24L24 45.8096Z" fill="currentColor"></path>
                                    </svg>
                                </div>
                                <h2 class="text-white text-lg font-bold leading-tight tracking-[-0.015em]">CinemaGest</h2>
                            </div>
                        </div>

                        <div class="flex flex-1 justify-end gap-4">
                            @if (User.Identity.IsAuthenticated)
                            {
                                <div class="text-white flex items-center gap-2">
                                    <span>Olá, @User.Identity.Name</span>
                                    <form asp-controller="Account" asp-action="Logout" method="post">
                                        <button type="submit" class="text-sm font-bold text-primary hover:text-white transition-colors">Sair</button>
                                    </form>
                                </div>
                            }
                            else
                            {
                                <a asp-controller="Account" asp-action="Login" class="flex min-w-[84px] cursor-pointer items-center justify-center rounded-lg h-10 px-4 bg-primary text-white text-sm font-bold hover:bg-primary/80 transition-colors">
                                    <span class="truncate">Login</span>
                                </a>
                            }
                        </div>
                    </header>

                    <main class="flex flex-col gap-8 mt-8">

                        <section class="flex flex-col gap-2">
                            <h2 class="text-white text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5">
                                🍿 Em Cartaz
                            </h2>
                            <p class="text-white/60 text-sm px-4 mb-4">Escolha o seu filme e reserve o seu lugar!</p>
                        </section>

                        <section class="flex flex-col divide-y divide-white/10">

                            @foreach (var item in Model)
                            {
                                <div class="p-4 hover:bg-white/5 transition-colors duration-200">
                                    <div class="flex flex-col md:flex-row items-stretch justify-between gap-6 rounded-lg">

                                        @{
                                            var imagemUrl = !string.IsNullOrEmpty(item.CapaImagem) ? $"/imagens/{item.CapaImagem}" : "https://via.placeholder.com/300x450?text=Sem+Capa";
                                        }
                                        <div class="w-full bg-center bg-no-repeat aspect-video md:aspect-[2/3] bg-cover rounded-lg flex-1 md:max-w-48 shadow-lg"
                                             style='background-image: url("@imagemUrl");'>
                                        </div>

                                        <div class="flex flex-col gap-4 flex-[2_2_0px]">
                                            <div>
                                                <p class="text-white/60 text-sm font-normal leading-normal">
                                                    @item.Genero | @item.Duracao min
                                                </p>
                                                <h3 class="text-white text-xl font-bold leading-tight mt-1">
                                                    @item.Titulo
                                                </h3>
                                                <p class="text-white/60 text-sm font-normal leading-normal mt-2">
                                                    Uma experiência cinematográfica imperdível.
                                                </p>
                                            </div>

                                            <div class="flex flex-col gap-3 mt-auto">
                                                <div class="flex items-center gap-2">
                                                    <span class="material-symbols-outlined text-white/80 text-sm">schedule</span>
                                                    <p class="text-white/80 font-semibold text-sm">Sessões Disponíveis Hoje</p>
                                                </div>

                                                <div class="flex flex-wrap gap-2">
                                                    @if (item.Sessoes != null && item.Sessoes.Any())
                                                    {
                                                        @foreach (var sessao in item.Sessoes)
                                                        {
                                                            <div class="px-5 py-2 text-sm font-semibold text-white bg-white/10 rounded-lg border border-white/5">
                                                                @sessao.Hora.ToString("HH:mm")
                                                            </div>
                                                        }
                                                    }
                                                    else
                                                    {
                                                        <span class="text-primary text-sm font-medium">Esgotado / Sem sessões</span>
                                                    }
                                                </div>

                                                <div class="mt-4">
                                                    @if (User.Identity.IsAuthenticated)
                                                    {
                                                        <a asp-controller="Reservas" asp-action="Criar" asp-route-filmeId="@item.Id"
                                                           class="inline-flex w-full md:w-auto cursor-pointer items-center justify-center rounded-lg h-10 px-6 bg-primary text-white text-sm font-bold tracking-[0.015em] hover:bg-primary/80 transition-colors shadow-lg shadow-primary/20">
                                                            🎟️ Reservar Bilhete
                                                        </a>
                                                    }
                                                    else
                                                    {
                                                        <a asp-controller="Account" asp-action="Login"
                                                           onclick="return confirm('Precisa de fazer login para reservar. Ir para login?');"
                                                           class="inline-flex w-full md:w-auto cursor-pointer items-center justify-center rounded-lg h-10 px-6 bg-white/10 text-white text-sm font-bold border border-white/10 hover:bg-white/20 transition-colors">
                                                            🔒 Login para Reservar
                                                        </a>
                                                    }
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }

                        </section>
                    </main>
                </div>
            </div>
        </div>
    </div>
</body>
</html>